(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();class L{gameTime=0;maxStep=.05;lastTime=0;fps=0;isPaused=!1;tick(){if(this.isPaused)return 0;const t=performance.now();let s=(t-this.lastTime)/1e3;return this.fps=1e3/(t-this.lastTime),this.lastTime=t,s>this.maxStep&&(s=this.maxStep),this.gameTime+=s,s}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.lastTime=performance.now()}getGameTime(){return this.gameTime}getFPS(){return Math.round(this.fps)}}class T{keys=new Set;justPressed=new Set;justReleased=new Set;onKeyDown=t=>{t.repeat||(this.keys.add(t.key),this.justPressed.add(t.key))};onKeyUp=t=>{this.keys.delete(t.key),this.justReleased.add(t.key)};constructor(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)}dispose(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}update(){this.justPressed.clear(),this.justReleased.clear()}isDown(t){return this.keys.has(t)}wasPressed(t){return this.justPressed.has(t)}wasReleased(t){return this.justReleased.has(t)}}class C{entities=[];add(t){this.entities.push(t)}remove(t){this.entities=this.entities.filter(s=>s!==t)}update(t,s){for(const e of this.entities)e.update(t,s);this.handleCollisions(),this.entities=this.entities.filter(e=>e.alive)}render(t){for(const s of this.entities)s.render(t)}clear(){this.entities=[]}handleCollisions(){const t=this.entities.filter(e=>"colliderType"in e),s=e=>typeof e.layer=="number"&&typeof e.mask=="number";for(let e=0;e<t.length;e++)for(let i=e+1;i<t.length;i++){const n=t[e],o=t[i];if(s(n)&&s(o)&&((n.mask&o.layer)===0||(o.mask&n.layer)===0))continue;let a=!1;if(n.colliderType==="circle"&&o.colliderType==="circle"){const r=n.position.x-o.position.x,h=n.position.y-o.position.y;Math.sqrt(r*r+h*h)<n.radius+o.radius&&(a=!0)}else if(n.colliderType==="box"&&o.colliderType==="box")n.position.x<o.position.x+o.width&&n.position.x+n.width>o.position.x&&n.position.y<o.position.y+o.height&&n.position.y+n.height>o.position.y&&(a=!0);else{let r,h;n.colliderType==="circle"?(r=n,h=o):(r=o,h=n);const p=Math.max(h.position.x,Math.min(r.position.x,h.position.x+h.width)),c=Math.max(h.position.y,Math.min(r.position.y,h.position.y+h.height)),d=r.position.x-p,u=r.position.y-c;d*d+u*u<r.radius*r.radius&&(a=!0)}a&&(n.onCollision(o),o.onCollision(n))}}}class k{timer=new L;input=new T;entityManager=new C;isRunning=!1;hasLoopStarted=!1;ctx;uiLayers=[];uiCanvas;uiCtx;uiUpdateIntervalMs=0;uiTimeSinceUpdateMs=0;get screenSize(){return{x:this.ctx.canvas.width,y:this.ctx.canvas.height}}get running(){return this.isRunning}init(t){const s=document.querySelector(t.selector);if(!s)throw new Error(`Element with selector "${t.selector}" not found.`);const e=document.createElement("canvas");e.width=t.width||800,e.height=t.height||600,e.style.backgroundColor=t.backgroundColor||"black",e.id="game",s.appendChild(e),e.focus();const i=e.getContext("2d");if(!i)throw new Error("Failed to get 2D context from canvas.");this.ctx=i,this.onInit()}onInit(){}start(){this.isRunning||(this.isRunning=!0,this.timer.resume(),this.onResume(),this.hasLoopStarted||(this.hasLoopStarted=!0,requestAnimationFrame(this.gameLoop.bind(this))))}stop(){this.isRunning=!1,this.timer.pause(),this.onPause()}onPause(){}onResume(){}canTogglePause(){return!0}gameLoop(){this.input.wasPressed("Escape")&&this.canTogglePause()&&(this.isRunning?this.stop():(this.isRunning=!0,this.timer.resume(),this.onResume()));let t=0;this.isRunning&&(t=this.timer.tick(),this.update(t),this.render());const s=this.isRunning?t:1/60;this.updateAndRenderUI(s),this.input.update(),requestAnimationFrame(this.gameLoop.bind(this))}update(t){this.entityManager.update(t,this.screenSize)}render(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.save(),this.entityManager.render(this.ctx),t&&t(),this.ctx.restore()}updateAndRenderUI(t){if(!this.uiCtx||this.uiLayers.length===0||(this.uiTimeSinceUpdateMs+=t*1e3,this.uiUpdateIntervalMs>0&&this.uiTimeSinceUpdateMs<this.uiUpdateIntervalMs))return;this.uiTimeSinceUpdateMs=0;const s=this.uiCanvas.width,e=this.uiCanvas.height;for(const i of this.uiLayers)i.update(t);this.uiCtx.clearRect(0,0,s,e);for(const i of this.uiLayers)i.render(this.uiCtx,s,e)}addUILayer(t){this.uiCtx||this.createUiCanvas(),this.uiLayers.push(t)}removeUILayer(t){this.uiLayers=this.uiLayers.filter(s=>s!==t)}setUiUpdateInterval(t){this.uiUpdateIntervalMs=Math.max(0,t)}createUiCanvas(){const t=this.ctx.canvas.parentElement;if(!t)return;window.getComputedStyle(t).position==="static"&&(t.style.position="relative");const e=document.createElement("canvas");e.width=this.ctx.canvas.width,e.height=this.ctx.canvas.height,e.style.position="absolute",e.style.left="0",e.style.top="0";const i=this.ctx.canvas,n=window.getComputedStyle(i);e.style.width=n.width||i.style.width||"100%",e.style.height=n.height||i.style.height||"100%",e.style.aspectRatio=n.aspectRatio||i.style.aspectRatio||`${i.width} / ${i.height}`,e.style.objectFit=n.objectFit||i.style.objectFit||"contain",e.style.display=n.display||"block",e.style.pointerEvents="none",e.style.zIndex="2",e.id="ui",t.appendChild(e);const o=e.getContext("2d");if(!o)throw new Error("Failed to get 2D context from UI canvas.");this.uiCanvas=e,this.uiCtx=o}addEntity(t){this.entityManager.add(t)}}class w{position;alive;constructor(t={x:0,y:0},s=!0){this.position=t,this.alive=s}}class I{imageQueue=[];images=new Map;taskQueue=[];sounds=new Map;fonts=new Map;queueImage(t,s){this.imageQueue.push({key:t,src:s})}queueSound(t,s,e){this.queueTask("sound",()=>this.loadSound(e,t,s))}queueFont(t,s,e={}){this.queueTask("font",()=>this.loadFont(t,s,e))}queueTask(t,s){this.taskQueue.push({kind:t,run:s})}async loadAll(t){const s=this.imageQueue.length+this.taskQueue.length;let e=0;const i=new Map,n=(c,d)=>{const u=i.get(c)??{loaded:0,total:0};u.total+=d,i.set(c,u)},o=c=>{const d=i.get(c);d&&(d.loaded+=1)};this.imageQueue.length>0&&n("image",this.imageQueue.length);for(const c of this.taskQueue)n(c.kind,1);const a=()=>{const c=s===0?1:e/s,d={};for(const[u,f]of i.entries())d[u]={loaded:f.loaded,total:f.total,percent:f.total===0?1:f.loaded/f.total};t?.({loaded:e,total:s,percent:c,byType:d})};a();const r=this.imageQueue.map(({key:c,src:d})=>this.loadImage(d).then(u=>{this.images.set(c,u),e+=1,o("image"),a()})),h=this.taskQueue.map(({kind:c,run:d})=>d().then(()=>{e+=1,o(c),a()})),p=[...r,...h];await Promise.all(p),this.imageQueue=[],this.taskQueue=[]}getImage(t){const s=this.images.get(t);if(!s)throw new Error(`Image not loaded: ${t}`);return s}getSound(t){const s=this.sounds.get(t);if(!s)throw new Error(`Sound not loaded: ${t}`);return s}getFont(t){const s=this.fonts.get(t);if(!s)throw new Error(`Font not loaded: ${t}`);return s}loadImage(t){return new Promise((s,e)=>{const i=new Image;i.onload=()=>s(i),i.onerror=()=>e(new Error(`Failed to load image: ${t}`)),i.src=t})}async loadSound(t,s,e){const n=await(await fetch(e)).arrayBuffer(),o=await t.decodeAudioData(n);this.sounds.set(s,o)}async loadFont(t,s,e){const n=await new FontFace(t,`url(${s})`,e).load();document.fonts.add(n),this.fonts.set(t,n)}}class R{states=new Map;current;add(t){return this.states.set(t.name,t),this}set(t){const s=this.states.get(t);if(!s)throw new Error(`State not found: ${t}`);const e=this.current;e&&e.name===s.name||(e?.exit?.(s),this.current=s,s.enter?.(e))}update(t){this.current?.update(t)}render(){this.current?.render()}get currentState(){return this.current}}class m{anchor;offsetX;offsetY;parent;constructor(t={}){this.anchor=t.anchor??"top-left",this.offsetX=t.offsetX??0,this.offsetY=t.offsetY??0,this.parent=t.parent??null}update(t){}getAnchorPoint(t,s){switch(this.anchor){case"top-left":return{x:0,y:0};case"top-right":return{x:t,y:0};case"bottom-left":return{x:0,y:s};case"bottom-right":return{x:t,y:s};case"center":return{x:t/2,y:s/2}}}getLocalPosition(t,s){const e=this.getAnchorPoint(t,s);return{x:e.x+this.offsetX,y:e.y+this.offsetY}}}class x{name;visible=!0;elements=[];constructor(t){this.name=t}add(t){this.elements.push(t)}remove(t){this.elements=this.elements.filter(s=>s!==t)}setVisible(t){this.visible=t}update(t){if(this.visible)for(const s of this.elements)s.update(t)}render(t,s,e){if(this.visible)for(const i of this.elements)i.render(t,s,e)}}class v extends m{width;height;backgroundColor;borderColor;borderWidth;borderRadius;children=[];constructor(t){super(t),this.width=t.width,this.height=t.height,this.backgroundColor=t.backgroundColor??"rgba(0,0,0,0.5)",this.borderColor=t.borderColor??"rgba(255,255,255,0.2)",this.borderWidth=t.borderWidth??0,this.borderRadius=t.borderRadius??0}add(t){t.parent=this,this.children.push(t)}update(t){for(const s of this.children)s.update(t)}render(t,s,e){const i=this.getLocalPosition(s,e);t.save(),t.translate(i.x,i.y);const n=Math.max(0,Math.min(this.borderRadius,Math.min(this.width,this.height)/2));n>0?(t.beginPath(),t.moveTo(n,0),t.lineTo(this.width-n,0),t.quadraticCurveTo(this.width,0,this.width,n),t.lineTo(this.width,this.height-n),t.quadraticCurveTo(this.width,this.height,this.width-n,this.height),t.lineTo(n,this.height),t.quadraticCurveTo(0,this.height,0,this.height-n),t.lineTo(0,n),t.quadraticCurveTo(0,0,n,0),t.closePath(),t.fillStyle=this.backgroundColor,t.fill(),this.borderWidth>0&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke())):(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.width,this.height),this.borderWidth>0&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.strokeRect(0,0,this.width,this.height)));for(const o of this.children)o.render(t,this.width,this.height);t.restore()}}class E extends m{getScore;color;font;constructor(t){super(t),this.getScore=t.getScore,this.color=t.color??"#ffffff",this.font=t.font??"16px sans-serif"}render(t,s,e){const i=this.getLocalPosition(s,e);t.save(),t.font=this.font,t.fillStyle=this.color,t.textAlign=this.anchor==="center"?"center":this.anchor.endsWith("right")?"right":"left",t.textBaseline=this.anchor==="center"?"middle":"top",t.fillText(`SCORE: ${this.getScore()}`,i.x,i.y),t.restore()}}class A extends m{getText;color;font;constructor(t){super(t),this.getText=t.getText,this.color=t.color??"#ffffff",this.font=t.font??"18px sans-serif"}render(t,s,e){const i=this.getLocalPosition(s,e);t.save(),t.font=this.font,t.fillStyle=this.color,t.textAlign=this.anchor==="center"?"center":this.anchor.endsWith("right")?"right":"left",t.textBaseline=this.anchor==="center"?"middle":"top",t.fillText(this.getText(),i.x,i.y),t.restore()}}class S{input;constructor(t){this.input=t}getRotation(){return this.input.isDown("ArrowLeft")?-1:this.input.isDown("ArrowRight")?1:0}isThrusting(){return this.input.isDown("ArrowUp")}}class M extends w{radius=15;colliderType="circle";angle=0;velocity={x:0,y:0};thrust=0;friction=.98;sprite;get controller(){return this._controller}_controller;constructor(t,s,e){super(t),this._controller=s,this.sprite=e}update(t,s){this.angle+=this.controller.getRotation()*180*t,this.controller.isThrusting()?this.thrust=200:this.thrust=0,this.velocity.x+=Math.cos(this.angle*Math.PI/180)*this.thrust*t,this.velocity.y+=Math.sin(this.angle*Math.PI/180)*this.thrust*t,this.velocity.x*=this.friction,this.velocity.y*=this.friction,this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t;const e=s.x,i=s.y;this.position.x<0&&(this.position.x+=e),this.position.x>e&&(this.position.x-=e),this.position.y<0&&(this.position.y+=i),this.position.y>i&&(this.position.y-=i)}render(t){if(t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.angle*Math.PI/180),this.sprite){t.rotate(Math.PI/2);const s=this.radius*2.4/this.sprite.width,e=this.sprite.width*s,i=this.sprite.height*s;t.drawImage(this.sprite,-e/2,-i/2,e,i)}else{const e=this.radius*1.3;t.beginPath(),t.moveTo(e,0),t.lineTo(-e*.6,-e*.6),t.lineTo(-e*.3,0),t.lineTo(-e*.6,e*.6),t.closePath(),t.strokeStyle="#ffffff",t.lineWidth=2,t.lineJoin="round",t.stroke()}t.restore()}getAngle(){return this.angle}onCollision(t){this.alive=!1}}class b extends w{radius=2;colliderType="circle";velocity;constructor(t,s,e=400){super(t);const i=s*Math.PI/180;this.velocity={x:Math.cos(i)*e,y:Math.sin(i)*e}}update(t,s){this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,(this.position.x<0||this.position.x>s.x||this.position.y<0||this.position.y>s.y)&&(this.alive=!1)}render(t){t.save(),t.translate(this.position.x,this.position.y),t.beginPath(),t.arc(0,0,this.radius,0,Math.PI*2),t.fillStyle="#ffff00",t.fill(),t.restore()}onCollision(t){this.alive=!1}}const U={XL:48,L:32,M:22,S:14},D={XL:"L",L:"M",M:"S",S:null},W={XL:20,L:50,M:100,S:200};class y extends w{radius;colliderType="circle";size;angle;rotationSpeed;velocity;shapePoints;shouldSplit=!1;hasSplit=!1;onDestroyed;hasScored=!1;constructor(t,s="L",e){super(t),this.size=s,this.radius=U[s],this.onDestroyed=e,this.angle=Math.random()*360,this.rotationSpeed=(Math.random()-.5)*90;const i=50+Math.random()*100,n=Math.random()*Math.PI*2;this.velocity={x:Math.cos(n)*i,y:Math.sin(n)*i};const o=8;this.shapePoints=Array.from({length:o},(a,r)=>({angle:r*Math.PI*2/o,scale:.75+Math.random()*.5}))}update(t,s){this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t;const e=s.x,i=s.y;this.position.x<0&&(this.position.x+=e),this.position.x>e&&(this.position.x-=e),this.position.y<0&&(this.position.y+=i),this.position.y>i&&(this.position.y-=i),this.angle+=this.rotationSpeed*t}render(t){const s=this.radius;t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.angle*Math.PI/180),t.beginPath();const e=this.shapePoints[0];t.moveTo(Math.cos(e.angle)*s*e.scale,Math.sin(e.angle)*s*e.scale);for(let i=1;i<this.shapePoints.length;i++){const n=this.shapePoints[i];t.lineTo(Math.cos(n.angle)*s*n.scale,Math.sin(n.angle)*s*n.scale)}t.closePath(),t.strokeStyle="#ffffff",t.lineWidth=2,t.stroke(),t.restore()}setVelocity(t){this.velocity=t}split(){if(!this.shouldSplit||this.hasSplit)return[];this.hasSplit=!0;const t=D[this.size];if(!t)return[];const s=this.radius*.8,e=Math.random()*Math.PI*2,i=Math.cos(e)*s,n=Math.sin(e)*s,o=new y({x:this.position.x+i,y:this.position.y+n},t,this.onDestroyed),a=new y({x:this.position.x-i,y:this.position.y-n},t,this.onDestroyed);return o.setVelocity({x:this.velocity.x+i*2,y:this.velocity.y+n*2}),a.setVelocity({x:this.velocity.x-i*2,y:this.velocity.y-n*2}),[o,a]}getScoreValue(){return W[this.size]}onCollision(t){if(t instanceof b){this.hasScored||(this.hasScored=!0,this.onDestroyed?.(this)),this.shouldSplit=!0,this.alive=!1;return}t instanceof y&&y.resolveCollision(this,t)}static resolveCollision(t,s){const e=s.position.x-t.position.x,i=s.position.y-t.position.y,n=Math.hypot(e,i)||1,o=e/n,a=i/n,r=t.radius+s.radius-n;if(r>0){const g=r/2;t.position.x-=o*g,t.position.y-=a*g,s.position.x+=o*g,s.position.y+=a*g}const h=s.velocity.x-t.velocity.x,p=s.velocity.y-t.velocity.y,c=h*o+p*a;if(c>0)return;const d=-1.9*c/2,u=d*o,f=d*a;t.velocity.x-=u,t.velocity.y-=f,s.velocity.x+=u,s.velocity.y+=f}}class F extends m{getLives;maxLives;color;size;spacing;constructor(t){super(t),this.getLives=t.getLives,this.maxLives=t.maxLives??3,this.color=t.color??"#00ff6a",this.size=t.size??12,this.spacing=t.spacing??8}render(t,s,e){const i=this.getLocalPosition(s,e),n=Math.max(0,Math.min(this.getLives(),this.maxLives));t.save(),t.translate(i.x,i.y);const o=n>0?n*this.size+(n-1)*this.spacing:0,a=this.anchor==="center"?-o/2:this.anchor.endsWith("right")?-o:0,r=this.anchor==="center"?this.size*.15:0;for(let h=0;h<n;h++){const p=a+h*(this.size+this.spacing)+this.size/2;this.drawShip(t,p,r)}t.restore()}drawShip(t,s,e){const i=this.size;t.save(),t.translate(s,e),t.beginPath(),t.moveTo(0,-i),t.lineTo(-i*.6,i*.7),t.lineTo(0,i*.3),t.lineTo(i*.6,i*.7),t.closePath(),t.strokeStyle=this.color,t.lineWidth=2,t.lineJoin="round",t.stroke(),t.restore()}}class q extends k{assets=new I;progress=0;shipSprite;score=0;lives=3;hudLayer=new x("HUD");pauseLayer=new x("Pause");player;asteroids=[];stateMachine=new R;onInit(){this.setUiUpdateInterval(100),this.setupUi(),this.setupStates(),this.stateMachine.set("loading")}update(t){this.stateMachine.update(t)}render(){this.stateMachine.render()}updatePlaying(t){if(this.input.wasPressed(" ")){const e=this.player.getAngle(),i=e*Math.PI/180,n=this.player.radius*1.2,o={x:this.player.position.x+Math.cos(i)*n,y:this.player.position.y+Math.sin(i)*n};this.addEntity(new b(o,e))}super.update(t),!this.player.alive&&this.lives>0&&(this.lives-=1,this.lives>0&&(this.player=new M({x:this.ctx.canvas.width/2,y:this.ctx.canvas.height/2},new S(this.input),this.shipSprite),this.addEntity(this.player)));const s=[];this.asteroids=this.asteroids.filter(e=>e.alive?!0:(s.push(...e.split()),!1));for(const e of s)this.addAsteroid(e)}renderPlaying(){super.render()}renderTextScreen(t,s){const e=this.ctx.canvas.width,i=this.ctx.canvas.height;this.ctx.clearRect(0,0,e,i),this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,e,i),this.ctx.fillStyle="#ffffff",this.ctx.font="36px sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(t,e/2,i/2-20),s&&(this.ctx.fillStyle="rgba(255,255,255,0.8)",this.ctx.font="18px sans-serif",this.ctx.fillText(s,e/2,i/2+20))}setupUi(){const t=new v({anchor:"top-left",offsetX:(this.ctx.canvas.width-160)/2,offsetY:10,width:160,height:40,backgroundColor:"rgba(0,0,0,0.6)"}),s=new E({getScore:()=>this.score,anchor:"center",offsetX:0,offsetY:0,parent:t});t.add(s),this.hudLayer.add(t);const e=new v({anchor:"bottom-right",offsetX:-150,offsetY:-50,width:140,height:40,backgroundColor:"rgba(0,0,0,0.4)",borderWidth:0}),i=new F({getLives:()=>this.lives,maxLives:3,anchor:"center",parent:e,color:"#00ff6a",size:10,spacing:10});e.add(i),this.hudLayer.add(e),this.addUILayer(this.hudLayer);const n=new v({anchor:"center",offsetX:-120,offsetY:-35,width:240,height:70,backgroundColor:"rgba(28, 54, 92, 0.9)",borderColor:"rgba(120, 196, 255, 0.9)",borderWidth:3,borderRadius:16}),o=new A({getText:()=>"PAUSED",anchor:"center",parent:n,offsetY:0,color:"rgba(120, 196, 255, 0.9)",font:"28px sans-serif"});n.add(o),this.pauseLayer.add(n),this.pauseLayer.setVisible(!1),this.addUILayer(this.pauseLayer)}setupStates(){const t={name:"loading",enter:()=>{this.assets.queueImage("ship","/spaceship.png"),this.assets.loadAll(o=>{this.progress=o.percent}).then(()=>{this.shipSprite=this.assets.getImage("ship"),this.stateMachine.set("menu")})},update:()=>{},render:()=>{this.renderLoading()}},s={name:"menu",enter:()=>{this.pauseLayer.setVisible(!1)},update:()=>{this.input.wasPressed("Enter")&&(this.resetGame(),this.stateMachine.set("playing"))},render:()=>{this.renderTextScreen("Asteroids","Press Enter to Start")}},e={name:"playing",enter:()=>{this.pauseLayer.setVisible(!1)},update:o=>{if(this.input.wasPressed("p")){this.stateMachine.set("paused");return}this.updatePlaying(o),this.lives===0&&!this.player.alive&&this.stateMachine.set("gameover")},render:()=>{this.renderPlaying()}},i={name:"paused",enter:()=>{this.pauseLayer.setVisible(!0)},update:()=>{this.input.wasPressed("p")&&this.stateMachine.set("playing")},render:()=>{this.renderPlaying()},exit:()=>{this.pauseLayer.setVisible(!1)}},n={name:"gameover",update:()=>{this.input.wasPressed("Enter")&&this.stateMachine.set("menu")},render:()=>{this.renderTextScreen("Game Over",`Score: ${this.score}`)}};this.stateMachine.add(t).add(s).add(e).add(i).add(n)}resetGame(){this.score=0,this.lives=3,this.asteroids=[],this.entityManager.clear(),this.player=new M({x:this.ctx.canvas.width/2,y:this.ctx.canvas.height/2},new S(this.input),this.shipSprite),this.addEntity(this.player),this.addAsteroid(new y({x:150,y:120},"XL",this.onAsteroidDestroyed)),this.addAsteroid(new y({x:650,y:200},"L",this.onAsteroidDestroyed)),this.addAsteroid(new y({x:400,y:450},"M",this.onAsteroidDestroyed))}addAsteroid(t){this.asteroids.push(t),this.addEntity(t)}onAsteroidDestroyed=t=>{this.score+=t.getScoreValue()};canTogglePause(){const t=this.stateMachine.currentState?.name;return t==="playing"||t==="paused"}onPause(){this.pauseLayer.setVisible(!0)}onResume(){this.pauseLayer.setVisible(!1)}renderLoading(){const t=this.ctx.canvas.width,s=this.ctx.canvas.height;this.ctx.clearRect(0,0,t,s),this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,t,s);const e=300,i=16,n=(t-e)/2,o=s/2-i/2;this.ctx.fillStyle="rgba(255,255,255,0.2)",this.ctx.fillRect(n,o,e,i),this.ctx.fillStyle="rgba(120, 196, 255, 0.9)",this.ctx.fillRect(n,o,e*this.progress,i),this.ctx.fillStyle="#ffffff",this.ctx.font="18px sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="bottom",this.ctx.fillText("Loading assets...",t/2,o-10)}}const P=new q;P.init({selector:"#app",width:800,height:600,backgroundColor:"#000000"});P.start();
